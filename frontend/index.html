<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LandOS — Dublin Parcel Explorer</title>

  <!-- MapLibre GL JS (CDN) -->
  <link rel="stylesheet" href="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.css" />
  <script src="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.js"></script>

  <link rel="stylesheet" href="style.css?v=12" />
</head>
<body>

  <!-- Map canvas -->
  <div id="map"></div>

  <!-- Search bar -->
  <div id="search-container">
    <input
      id="search-input"
      type="text"
      placeholder="Search Dublin… e.g. Stoneybatter, D7"
      autocomplete="off"
    />
    <button id="search-btn">Search</button>
    <div id="search-results"></div>
  </div>

  <!-- Layer toggle panel -->
  <div id="layer-panel">
    <h3>Layers</h3>
    <button id="circle-mode-btn" type="button">Circle Analysis</button>
    <hr style="border:none;border-top:1px solid #333;margin:10px 0 8px;">
    <div id="layer-list">
      <!-- Populated by app.js after /api/layers -->
    </div>
  </div>

  <!-- Zoom hint -->
  <div id="zoom-hint">Zoom in to see parcels (zoom 15+)</div>

  <!-- Detail sidebar -->
  <div id="sidebar">
    <div id="sidebar-header">
      <span id="sidebar-title">Parcel Detail</span>
      <button id="sidebar-close" title="Close">&#x2715;</button>
    </div>
    <div id="sidebar-content">
      <p style="color:#555; font-size:13px;">Click a parcel to see its details.</p>
    </div>
  </div>

  <!-- AI Assistant Panel -->
  <div id="ai-panel">
    <div id="ai-panel-header" title="Click to expand">
      <div id="ai-panel-toggle">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2a4 4 0 0 1 4 4v1a3 3 0 0 1 3 3v1a2 2 0 0 1-2 2h-1v3l-3-3H7a2 2 0 0 1-2-2v-1a3 3 0 0 1 3-3V6a4 4 0 0 1 4-4z"/>
          <circle cx="9" cy="10" r="1"/><circle cx="15" cy="10" r="1"/>
        </svg>
        <span>AI Site Finder</span>
      </div>
      <button id="ai-panel-expand" title="Expand/Collapse">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="18 15 12 9 6 15"/>
        </svg>
      </button>
    </div>

    <div id="ai-panel-body">
      <div id="ai-messages">
        <div class="ai-msg ai-msg-assistant">
          <div class="ai-msg-content">Explore Dublin development opportunities. Pick an analysis below or type your own query.</div>
        </div>
      </div>

      <div id="ai-starter-options"></div>
      <!-- explainer gets inserted here dynamically -->

      <div id="ai-insights-container" style="display:none;"></div>

      <div id="ai-results-container" style="display:none;">
        <div id="ai-results-header">
          <span id="ai-results-count"></span>
          <button id="ai-results-close" title="Clear results">&#x2715;</button>
        </div>
        <div id="ai-results-list"></div>
      </div>

      <div id="ai-suggestions"></div>

      <div id="ai-input-row">
        <input
          id="ai-input"
          type="text"
          placeholder="Type any question — areas, prices, sites, planning…"
          autocomplete="off"
        />
        <button id="ai-send" title="Send">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <script src="app.js?v=12"></script>
</body>
</html>
